<!DOCTYPE html>
<html>
<head lang="en">

    <meta charset="UTF-8">
    <title></title>

    <link rel="stylesheet" href="lookup/bootstrap/mybootstrap.css">
    <link rel="stylesheet" href="lookup/datatables/jquery.dataTables.css">

    <script src="libs.js"></script>
    <script src="templates.js"></script>

</head>
<body>

<div data-bind="template: 'navbar-template'"></div>

<br>
<br>

<div data-bind="template: currentView()"></div>

<table id="table"></table>

<script>
    var model = {
        currentView: ko.observable("home-template")
    };
    ko.applyBindings(model);

    var t = $('table').DataTable(
        {
            "data": [],
            "columns": [
                { "title": "name" },
                { "title": "other" },
                { "title": "x" },
                { "title": "y" },
                { "title": "z" }
            ]
        }
    );

    Server.loggedIn.subscribe(function(value) {
        if ( value ) {
            Server.session().$query("TestRecord", "true", function (change, error) {
                console.log(change);
                if ( change.type != RL_SNAPSHOT_DONE ) {
                    t.row.add(change.newRecord);
                } else {
                    t.draw();
                }
            });
        }
    });
</script>

</body>
</html>